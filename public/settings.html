<!DOCTYPE html>
<html>
<head>
  <title>Settings</title>
</head>
<body>
  <h2>Select Audio Input</h2>
  <form method="POST" action="/set-device">
    <select name="device" id="deviceSelect"></select>
    <button type="submit">Set</button>
  </form>

  <h2>FFmpeg Stream Settings</h2>
  <form method="POST" action="/set-ffmpeg">
    <label>Bitrate:
      <select name="bitrate">
        <option value="128k">128k</option>
        <option value="192k">192k</option>
        <option value="256k" selected>256k</option>
        <option value="320k">320k</option>
      </select>
    </label><br><br>

    <label>Cutoff Frequency:
      <select name="cutoff">
        <option value="16000">16000</option>
        <option value="18000">18000</option>
        <option value="19000" selected>19000</option>
        <option value="20000">20000</option>
      </select>
    </label><br><br>

    <label>Output Format:
      <select name="format">
        <option value="adts" selected>adts</option>
        <option value="flv">flv</option>
        <option value="mp4">mp4</option>
      </select>
    </label><br><br>

    <button type="submit">Save Settings</button>
  </form>

  <script>
    fetch('/devices')
      .then(res => res.json())
      .then(data => {
        const sel = document.getElementById('deviceSelect');
        data.devices.forEach(device => {
          const opt = document.createElement('option');
          opt.value = device;
          opt.textContent = device;
          if (device === data.selected) opt.selected = true;
          sel.appendChild(opt);
        });
      });
  </script>
</body>
</html>
